ğŸ—ï¸ ESL Writing App ì‹œìŠ¤í…œ ì„¤ê³„ì„œ (v2.0 - Production Ready)
ë²„ì „: 2.0 (Grok ë¦¬ë·° ë°˜ì˜)

ëª©í‘œ: 1ì¸/ì†Œê·œëª¨ íŒ€ì´ ê°€ì¥ ë¹ ë¥´ê³  ì•ˆì „í•˜ê²Œ ëŸ°ì¹­ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ ìˆ˜ë¦½

1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (Tech Stack)
ì´ˆê¸° ë¹„ìš© ì ˆê°ê³¼ ê°œë°œ ì†ë„ë¥¼ ìœ„í•´ Serverless & PWAë¡œ ì‹œì‘í•˜ë˜, ê²°ì œì™€ ì•Œë¦¼ì€ ì „ë¬¸ ì†”ë£¨ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ìŠ¤í¬ë¥¼ ì œê±°í•©ë‹ˆë‹¤.

Frontend (Web & Mobile): Next.js 14+ (App Router)
PWA: next-pwa ì ìš© (í™ˆ í™”ë©´ ì¶”ê°€, ì˜¤í”„ë¼ì¸ ì§€ì›).
Mobile Roadmap: MVP ê²€ì¦ í›„ 3ê°œì›” ë‚´ Capacitorë¥¼ í†µí•´ ë„¤ì´í‹°ë¸Œ ì•±(Android/iOS)ìœ¼ë¡œ íŒ¨í‚¤ì§•.
Backend: Next.js API Routes (Serverless Functions).
Database & Auth: Supabase
DB: PostgreSQL (JSONB í™œìš©).
Security: RLS(Row Level Security) í•„ìˆ˜ ì ìš©.
Realtime: ë¶€ëª¨ë‹˜ ê¸°ê¸°ë¡œ ì‹¤ì‹œê°„ ì•Œë¦¼ ì „ì†¡.
AI Engine: OpenAI API (GPT-4o)
Safety: OpenAI Moderation Endpoint í•„ìˆ˜ ê²½ìœ .
Infrastructure: Vercel (Pro Plan ê¶Œì¥ - ìƒìš©í™” ì‹œ).
Payments (ì‹ ê·œ ì¶”ê°€): RevenueCat
ì´ìœ : ì¸ì•± ê²°ì œ(IAP) ì˜ìˆ˜ì¦ ê²€ì¦ ë¡œì§ êµ¬í˜„ì˜ ë³µì¡ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ ë¹„ìš© ì œê±°.
Notifications (ì‹ ê·œ ì¶”ê°€): FCM (Firebase Cloud Messaging)
ì´ìœ : ë‹¨ìˆœ DB ë¡œê·¸ê°€ ì•„ë‹Œ, ì‹¤ì œ ë¶€ëª¨ë‹˜ í°ì„ ìš¸ë¦¬ëŠ” í‘¸ì‹œ ì•Œë¦¼ êµ¬í˜„.

2. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ (PostgreSQL + RLS)
Grokì˜ í”¼ë“œë°±ëŒ€ë¡œ **ë³´ì•ˆ ì •ì±…(RLS)**ì„ ê¸°ë³¸ìœ¼ë¡œ ê¹”ê³ , ì•„ì´í…œ ê´€ë¦¬ë¥¼ ì •ê·œí™”í–ˆìŠµë‹ˆë‹¤.

A. profiles (ì‚¬ìš©ì ì •ë³´ + ì¬í™”)
ë³´ì•ˆ: ë³¸ì¸ ë°ì´í„°ë§Œ ì¡°íšŒ ê°€ëŠ¥ (RLS).
ì»¬ëŸ¼: grade, publisher, energy, gems, is_premium, vision_usage_today.

B. missions (ì»¤ë¦¬í˜ëŸ¼)
êµ¬ì¡°: êµê³¼ì„œ ë©”íƒ€ë°ì´í„°ëŠ” jsonbë¡œ ìœ ì—°í•˜ê²Œ ì €ì¥í•˜ë˜, ê²€ìƒ‰ ì„±ëŠ¥ì„ ìœ„í•´ ì¸ë±ì‹± ì ìš©.

C. study_logs (í•™ìŠµ ê¸°ë¡ & Queue)
UGC ì œí•œ: ì´ˆê¸°ì—ëŠ” is_public ì»¬ëŸ¼ì„ falseë¡œ ê³ ì •í•˜ì—¬ 'ë‚˜ë§Œì˜ ë„ì„œê´€' ê¸°ëŠ¥ë§Œ ì œê³µ. (ê³µê°œ ê°¤ëŸ¬ë¦¬ ë¦¬ìŠ¤í¬ ì°¨ë‹¨).
Queue ìƒíƒœ: status ('completed', 'queued')ë¡œ ê´€ë¦¬.

D. shop_items & user_inventory (ìƒì  & ì¸ë²¤í† ë¦¬)
ë¶„ë¦¬: í™•ì¥ì„±ì„ ìœ„í•´ ì•„ì´í…œ ì •ì˜ í…Œì´ë¸”ê³¼ ìœ ì € ë³´ìœ  í…Œì´ë¸” ë¶„ë¦¬.
íŠ¸ëœì­ì…˜: ì•„ì´í…œ êµ¬ë§¤ ì‹œ (ì ¬ ì°¨ê° + ì•„ì´í…œ ì§€ê¸‰)ì€ DB íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬.

3. í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° ì•ˆì „ì¥ì¹˜
â‘  3ì¤‘ ì•ˆì „ í•„í„°ë§ (Safety Pipeline)
ì•„ë™ ì•±ì˜ í•„ìˆ˜ ìš”ì†Œì¸ ìš•ì„¤ ì°¨ë‹¨ì„ 3ë‹¨ê³„ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤.

Client: bad-words ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì…ë ¥ì°½ì—ì„œ ì¦‰ì‹œ ë¸”ë½ ("ë‚˜ìœ ë§ì€ ì•ˆ ë¼ìš”!").
Server Middleware: OpenAI Moderation API í˜¸ì¶œ (ì„±ì /í­ë ¥ì  ì½˜í…ì¸  ê°ì§€).
AI Coach: í˜ë¥´ì†Œë‚˜ í”„ë¡¬í”„íŠ¸ì— "ë¶€ì ì ˆí•œ ë‚´ìš©ì´ ê°ì§€ë˜ë©´ ë¶€ë“œëŸ½ê²Œ ì£¼ì œë¥¼ ëŒë¦¬ë¼"ëŠ” ì§€ì‹œ í¬í•¨.
Action: 2ë²ˆ ë‹¨ê³„ì—ì„œ ì ë°œ ì‹œ notifications í…Œì´ë¸”ì— ê¸°ë¡ ë° ë¶€ëª¨ í‘¸ì‹œ ë°œì†¡.

â‘¡ ê²°ì œ ë° í”„ë¦¬ë¯¸ì—„ ë¡œì§ (RevenueCat ì—°ë™)
êµ¬ë§¤: í´ë¼ì´ì–¸íŠ¸ì—ì„œ RevenueCat SDKë¡œ ê²°ì œ ìˆ˜í–‰.
ê²€ì¦: Webhookì„ í†µí•´ Supabase DBì˜ profiles í…Œì´ë¸” (is_premium, gems) ì—…ë°ì´íŠ¸.
ì˜ˆì™¸ ì²˜ë¦¬: IAPë¡œ 'ì—ë„ˆì§€' êµ¬ë§¤ ì‹œ, í•´ë‹¹ ì„¸ì…˜ í”Œë˜ê·¸ë¥¼ skip_queue: trueë¡œ ì„¤ì •í•˜ì—¬ ì¦‰ì‹œ í”¼ë“œë°± ì œê³µ.

â‘¢ ë°ì´í„° ì½œë“œ ìŠ¤íƒ€íŠ¸ ëŒ€ì‘
ì´ˆê¸° ë¦¬í¬íŠ¸: ë² íƒ€ ìœ ì € 500ëª… ë‹¬ì„± ì „ê¹Œì§€ëŠ” "ë˜ë˜ ë¹„êµ" UIë¥¼ ìˆ¨ê¸°ê³ , "êµìœ¡ë¶€ ê¶Œì¥ ì„±ì·¨ë„(ì ˆëŒ€í‰ê°€)" ê·¸ë˜í”„ë§Œ ë…¸ì¶œ.

4. API ì„¤ê³„ (ì£¼ìš” Endpoints)
Method, Endpoint, ê¸°ëŠ¥ ë° ë³´ì•ˆ
POST, /api/auth/guest, ê²ŒìŠ¤íŠ¸ ë¡œê·¸ì¸ (ìµëª… ê³„ì • ìƒì„±).
POST, /api/study/submit, (í•µì‹¬) í•„í„°ë§ â†’ AI ì²˜ë¦¬ â†’ ì €ì¥. (RLS ì ìš©).
POST, /api/shop/purchase, ì•„ì´í…œ êµ¬ë§¤ (íŠ¸ëœì­ì…˜). RevenueCat ê²€ì¦.
GET, /api/ugc/my-library, (ì•ˆì „) ë‚´ ê¸€ë§Œ ì¡°íšŒ. (ê³µê°œ ê°¤ëŸ¬ë¦¬ APIëŠ” ì¶”í›„ ê°œë°œ).
POST, /api/parents/push-token, ë¶€ëª¨ë‹˜ ê¸°ê¸°ì˜ FCM í† í° ë“±ë¡.

5. ê°œë°œ ë¡œë“œë§µ (Action Plan)
Phase 1. ê¸°ë°˜ ë° ë³´ì•ˆ (Week 1)
Supabase í”„ë¡œì íŠ¸ ìƒì„± ë° RLS ì •ì±…ì´ í¬í•¨ëœ SQL ì‹¤í–‰.
Next.js PWA ì„¸íŒ… + OpenAI Moderation ì—°ë™ í…ŒìŠ¤íŠ¸.
RevenueCat ê³„ì • ìƒì„± ë° ìƒŒë“œë°•ìŠ¤ í…ŒìŠ¤íŠ¸.

Phase 2. í•µì‹¬ ê²½í—˜ (Week 2-3)
ê²ŒìŠ¤íŠ¸ ëª¨ë“œ â†’ L1 ì²´í—˜ â†’ ê°€ì… ì˜¨ë³´ë”© í”Œë¡œìš° êµ¬í˜„.
AI íƒí—˜ëŒ€ì¥ í”„ë¡¬í”„íŠ¸ íŠœë‹ ë° Writing ê¸°ëŠ¥ ê°œë°œ.

Phase 3. í™•ì¥ ë° ëŸ°ì¹­ (Week 4)
ìƒì (ì•„ì´í…œ êµ¬ë§¤) êµ¬í˜„.
í•™ë¶€ëª¨ ë¦¬í¬íŠ¸ UI ê°œë°œ.
ë‚´ë¶€ ë² íƒ€ í…ŒìŠ¤íŠ¸ ì§„í–‰ (ì§€ì¸ 10ëª…).

ğŸ [ë¶€ë¡] Supabase ìµœì¢… SQL ìŠ¤í¬ë¦½íŠ¸ (ì¦‰ì‹œ ì‹¤í–‰ìš©)
Grokì´ ê°•ì¡°í•œ RLS(ë³´ì•ˆ), ì¸ë±ì‹±(ì„±ëŠ¥), ì•„ì´í…œ ì •ê·œí™”ê°€ ëª¨ë‘ ì ìš©ëœ ì½”ë“œì…ë‹ˆë‹¤. ë³µì‚¬í•´ì„œ Supabase SQL Editorì— ì‹¤í–‰í•˜ì„¸ìš”.

SQL

-- 1. ìœ ì € í”„ë¡œí•„ (ì¬í™” ë° ìƒíƒœ)
create table profiles (
  id uuid references auth.users not null primary key,
  grade int,
  publisher text, -- 'chunjae', 'ybm'
  level int default 1,
  -- ì¬í™”
  energy int default 5,
  gems int default 0,
  -- ìƒíƒœ ë° ì œí•œ
  is_premium boolean default false,
  vision_usage_today int default 0,
  feedback_usage_today int default 0,
  created_at timestamp with time zone default now(),
  updated_at timestamp with time zone default now()
);
-- 2. ìƒì  ì•„ì´í…œ (í™•ì¥ì„± ê³ ë ¤)
create table shop_items (
  id bigint generated by default as identity primary key,
  name text not null,
  type text not null, -- 'outfit', 'decoration'
  cost_gems int not null,
  image_url text
);
-- 3. ìœ ì € ì¸ë²¤í† ë¦¬
create table user_inventory (
  id bigint generated by default as identity primary key,
  user_id uuid references profiles(id) not null,
  item_id bigint references shop_items(id) not null,
  is_equipped boolean default false,
  created_at timestamp default now()
);
-- 4. í•™ìŠµ ë¡œê·¸ (UGC ì•ˆì „ì¥ì¹˜ í¬í•¨)
create table study_logs (
  id uuid default uuid_generate_v4() primary key,
  user_id uuid references profiles(id) not null,
  mission_text text,
  user_input text,
  ai_feedback jsonb,
  -- ìƒíƒœ ê´€ë¦¬
  status text default 'completed', -- 'queued'
  is_public boolean default false, -- ì´ˆê¸°ì—” falseë¡œ ê³ ì • (ë‚˜ë§Œì˜ ë„ì„œê´€)
  created_at timestamp default now()
);
-- 5. ë³´ì•ˆ ì •ì±… (RLS - í•„ìˆ˜!)
alter table profiles enable row level security;
alter table user_inventory enable row level security;
alter table study_logs enable row level security;
-- "ë‚´ ë°ì´í„°ëŠ” ë‚˜ë§Œ ë³¼ ìˆ˜ ìˆë‹¤" ì •ì±…
create policy "Users can view own profile" on profiles for select using (auth.uid() = id);
create policy "Users can update own profile" on profiles for update using (auth.uid() = id);
create policy "Users can view own logs" on study_logs for select using (auth.uid() = user_id);
create policy "Users can insert own logs" on study_logs for insert with check (auth.uid() = user_id);
-- 6. ì„±ëŠ¥ ì¸ë±ì‹±
create index idx_logs_user_date on study_logs (user_id, created_at desc);
create index idx_inventory_user on user_inventory (user_id);